<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ’²å…‹ç‰Œå°„é¾é–€ Demo (é‚è¼¯èˆ‡ç©©å®šä¿®æ­£ç‰ˆ)</title>
    <style>
        /* åŸºç¤æ¨£å¼ (æ²¿ç”¨) */
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #1a1a1a;
            color: #fff;
            margin: 0;
            padding: 20px;
        }

        #game-area {
            width: 800px;
            background-color: #006400;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            position: relative;
            min-height: 550px;
        }

        /* -------------------- ç©å®¶è³‡è¨Š/è¨ˆæ™‚å™¨ (æ²¿ç”¨) -------------------- */
        
        #player-info {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 10px;
            background-color: #333;
            border-radius: 8px;
            font-size: 1.2em;
        }

        #timer-display {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px;
            background-color: #f0ad4e;
            color: #333;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.5em;
            width: 100px; 
            text-align: center;
            display: none;
            z-index: 10;
        }

        /* -------------------- ä¸‹æ³¨åº§ä½ (æ²¿ç”¨) -------------------- */
        
        #betting-spots {
            display: flex;
            justify-content: space-around;
            margin-top: 300px; 
        }

        .bet-spot {
            width: 120px; 
            height: 100px;
            border: 3px dashed #ffeb3b;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bet-spot.locked {
            opacity: 0.5; 
            cursor: not-allowed;
        }

        .bet-spot.active-bet {
            border-color: #f0ad4e;
            box-shadow: 0 0 10px #f0ad4e;
        }

        .bet-spot:not(.locked):hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .current-bet {
            margin-top: 5px;
            font-size: 1.2em;
            color: #ffcc00;
            font-weight: bold;
        }

        /* -------------------- ç±Œç¢¼é¸æ“‡ (æ²¿ç”¨) -------------------- */
        
        #chip-selection {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
        }

        .chip-wrapper {
            cursor: pointer;
            border: 4px solid transparent; 
            border-radius: 50%;
            transition: border 0.1s;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .chip-wrapper img {
            width: 65px; 
            height: 65px;
            display: block;
        }

        .chip-wrapper.selected-chip {
            border: 4px solid #ffcc00; 
            box-shadow: 0 0 15px #ffeb3b;
        }

        /* -------------------- å¡ç‰Œé¡¯ç¤ºå€ (ç©©å®šä½ˆå±€ä¿®æ­£) -------------------- */
        #card-wrapper {
            position: absolute;
            width: 0px; 
            left: 0;
            top: 150px; 
            height: 130px; 
            transition: width 0.5s, left 0.5s;
        }

        #card-display {
            position: relative;
            /* ä¿®æ­£ï¼šè®“ card-display å¯¦éš›å¯¬åº¦åªåŒ…å«å…©å¼µç‰Œé–“è·ï¼Œç¢ºä¿çµ•å°å®šä½åŸºæº–ç©©å®š */
            width: 190px; 
            height: 120px;
            margin: 0 auto; 
        }

        .card {
            width: 80px;
            height: 120px;
            border-radius: 8px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
            background-size: cover;
            background-position: center;
            position: absolute; 
            transition: transform 0.5s, box-shadow 0.5s, filter 0.5s, opacity 0.5s; 
        }
        
        /* å®šä½ - å¡ç‰Œ 1 (å·¦é‚Š) */
        .card:nth-child(1) {
            left: 0;
            top: 10px; /* ç¨å¾®ä¸‹ç§» */
            z-index: 2;
        }
        
        /* å®šä½ - å¡ç‰Œ 2 (å³é‚Š) */
        .card:nth-child(2) {
            right: 0;
            top: 10px;
            z-index: 2;
        }

        /* å®šä½ - å¡ç‰Œ 3 (å°„é–€ç‰Œï¼Œå±…ä¸­ä¸¦é‡ç–Šï¼Œæ›´ç©©å®š) */
        .card:nth-child(3) {
            left: 50%;
            top: 0; 
            margin-left: -40px; 
            z-index: 5; 
            transform: scale(1.05); 
        }
        
        /* -------------------- çµæœè¦–è¦ºå›é¥‹ (æ²¿ç”¨) -------------------- */
        
        .card.win {
            box-shadow: 0 0 15px 5px rgba(255, 215, 0, 0.8), 
                        0 0 5px 1px rgba(255, 255, 255, 0.8); 
        }

        .card.lose {
            filter: grayscale(100%) brightness(0.7); 
            opacity: 0.7;
        }

        .card.win:nth-child(3), .card.lose:nth-child(3) {
            transform: scale(1.15); 
        }
        
        /* -------------------- å‹•ä½œæŒ‰éˆ• (æ²¿ç”¨) -------------------- */
        #action-buttons {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            opacity: 0; 
            transition: opacity 0.5s;
        }

        #action-buttons.active {
            opacity: 1;
        }

        .action-btn {
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .action-btn img {
            width: 120px; 
            height: auto;
            border-radius: 5px;
        }

        .action-btn:disabled img {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        #message-area {
            text-align: center;
            margin-top: 20px;
            font-size: 1.2em;
            color: #ccc;
        }

    </style>
</head>
<body>

    <h1>ğŸƒ å°„é¾é–€</h1>

    <div id="game-area">

        <div id="player-info">
            ç±Œç¢¼ï¼š<span id="player-chips">10000</span>
        </div>

        <div id="timer-display">
            10
        </div>

        <div id="card-wrapper">
            <div id="card-display">
                </div>
        </div>

        <div id="betting-spots">
            <div class="bet-spot" data-spot="1">
                åº§ä½ 1
                <span class="current-bet">ç±Œç¢¼: 0</span>
            </div>
            <div class="bet-spot" data-spot="2">
                åº§ä½ 2
                <span class="current-bet">ç±Œç¢¼: 0</span>
            </div>
            <div class="bet-spot" data-spot="3">
                åº§ä½ 3
                <span class="current-bet">ç±Œç¢¼: 0</span>
            </div>
            <div class="bet-spot" data-spot="4">
                åº§ä½ 4
                <span class="current-bet">ç±Œç¢¼: 0</span>
            </div>
        </div>

        <div id="chip-selection">
            <div class="chip-wrapper" data-amount="100">
                <img src="assets/chip_100.png" alt="100ç±Œç¢¼">
            </div>
            <div class="chip-wrapper" data-amount="500">
                <img src="assets/chip_500.png" alt="500ç±Œç¢¼">
            </div>
            <div class="chip-wrapper" data-amount="1000">
                <img src="assets/chip_1000.png" alt="1000ç±Œç¢¼">
            </div>
            <div class="chip-wrapper" data-amount="5000">
                <img src="assets/chip_5000.png" alt="5000ç±Œç¢¼">
            </div>
        </div>

        <div id="action-buttons">
            <button id="shoot-btn" class="action-btn" disabled>
                <img src="assets/btn_shoot.png" alt="å°„é–€">
            </button>
            <button id="fold-btn" class="action-btn" disabled>
                <img src="assets/btn_fold.png" alt="æ£„ç‰Œ">
            </button>
        </div>

    </div>

    <div id="message-area">
        è«‹é¸æ“‡ç±Œç¢¼ä¸¦é»æ“Šä¸€å€‹åº§ä½é–‹å§‹ä¸‹æ³¨ã€‚
    </div>

    <script>
        // -------------------- éŠæˆ²è®Šæ•¸èˆ‡ç‹€æ…‹ (æ²¿ç”¨) --------------------
        const SUITS = ['C', 'D', 'H', 'S']; 
        const CARD_RANKS = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const cardValueMap = { 'A': 1, 'J': 11, 'Q': 12, 'K': 13 };

        let playerChips = 10000;
        let selectedChipAmount = 0;
        let activeSpotId = null; 
        let totalBet = 0; 

        let dealtCards = []; 
        let gamePhase = 'betting'; 
        let timerId = null; 
        const BETTING_TIME = 10; 
        const POST_GAME_TIME = 5; 

        // -------------------- DOM å…ƒç´  (æ²¿ç”¨) --------------------
        const playerChipsDisplay = document.getElementById('player-chips');
        const chipWrappers = document.querySelectorAll('.chip-wrapper');
        const betSpots = document.querySelectorAll('.bet-spot'); 
        const messageArea = document.getElementById('message-area');
        const cardDisplay = document.getElementById('card-display');
        const cardWrapper = document.getElementById('card-wrapper');
        const actionButtons = document.getElementById('action-buttons');
        const shootBtn = document.getElementById('shoot-btn');
        const foldBtn = document.getElementById('fold-btn');
        const timerDisplay = document.getElementById('timer-display');


        // -------------------- è¼”åŠ©å‡½å¼ (æ²¿ç”¨) --------------------
        function getCardValue(cardSymbolRank) {
            const rank = cardSymbolRank.split('_')[0];
            return cardValueMap[rank] || parseInt(rank);
        }

        function drawCard() {
            let card = '';
            let attempts = 0;
            const maxAttempts = 52 * 5; 

            do {
                const randomSuit = SUITS[Math.floor(Math.random() * SUITS.length)];
                const randomRank = CARD_RANKS[Math.floor(Math.random() * CARD_RANKS.length)];
                card = `${randomRank}_${randomSuit}`;
                attempts++;
            } while (dealtCards.includes(card) && attempts < maxAttempts);

            if (attempts >= maxAttempts) {
                card = `${CARD_RANKS[0]}_${SUITS[0]}`; 
            }

            dealtCards.push(card);
            return card;
        }

        // -------------------- æ¸²æŸ“å¡ç‰Œ (æ²¿ç”¨) --------------------
        function renderCards(card1 = null, card2 = null, card3 = null, result = 'none') {
            cardDisplay.innerHTML = '';
            
            const cardsToRender = [card1, card2, card3].filter(c => c !== null); 

            if (cardsToRender.length > 0) {
                 cardWrapper.style.width = `190px`; 
            } else {
                 cardWrapper.style.width = `0px`; 
            }

            cardsToRender.forEach((cardSymbol, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                
                let imageUrl = '';
                if (cardSymbol === 'BACK') {
                    imageUrl = `assets/card_back.png`; 
                } else {
                    imageUrl = `assets/card_${cardSymbol}.png`; 
                }

                cardElement.style.backgroundImage = `url('${imageUrl}')`;
                
                if (result !== 'none') {
                    cardElement.classList.add(result);
                }
                
                cardDisplay.appendChild(cardElement);
            });
        }
        
        function positionCardDisplay(spotId) {
            const spotElement = document.querySelector(`.bet-spot[data-spot="${spotId}"]`);
            if (!spotElement) return;

            const spotRect = spotElement.getBoundingClientRect();
            const gameAreaRect = document.getElementById('game-area').getBoundingClientRect();
            
            const spotCenter = spotRect.left + spotRect.width / 2 - gameAreaRect.left;
            
            const cardDisplayWidth = parseInt(cardWrapper.style.width) || 190; 
            const newLeft = spotCenter - cardDisplayWidth / 2;

            cardWrapper.style.left = `${newLeft}px`;
        }


        // -------------------- è¨ˆæ™‚å™¨/UI/ç‹€æ…‹æ§åˆ¶ (æ²¿ç”¨) --------------------
        
        function startAutoNewGameTimer(seconds) {
            gamePhase = 'game_over_auto_restart'; 
            let timeLeft = seconds;
            
            timerDisplay.textContent = `ä¸‹ä¸€å±€: ${timeLeft}s`;
            timerDisplay.style.display = 'block';
            
            if (timerId) {
                clearInterval(timerId);
            }
            
            timerId = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `ä¸‹ä¸€å±€: ${timeLeft}s`;

                if (timeLeft <= 0) {
                    clearInterval(timerId);
                    timerDisplay.style.display = 'none';
                    resetGame(); 
                }
            }, 1000);
        }

        function startTimer() {
            let timeLeft = BETTING_TIME;
            timerDisplay.textContent = timeLeft;
            timerDisplay.style.display = 'block';

            if (timerId) {
                clearInterval(timerId);
            }

            timerId = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = timeLeft;

                if (timeLeft <= 0) {
                    clearInterval(timerId);
                    timerDisplay.style.display = 'none';
                    
                    if (gamePhase === 'betting') {
                        if (totalBet > 0) {
                            startDealing(); 
                        } else {
                            messageArea.textContent = "è©²å±€ç„¡äººä¸‹æ³¨ï¼Œå°‡è‡ªå‹•é‡æ–°é–‹å§‹æ–°å±€...";
                            startAutoNewGameTimer(POST_GAME_TIME); 
                        }
                    }
                }
            }, 1000);
        }

        function stopTimer() {
            if (timerId) {
                clearInterval(timerId);
                timerId = null;
            }
            timerDisplay.style.display = 'none';
        }

        function toggleBettingUI(enabled) {
            chipWrappers.forEach(wrapper => wrapper.style.pointerEvents = enabled ? 'auto' : 'none');
            
            betSpots.forEach(spot => {
                const spotId = spot.dataset.spot;
                
                if (enabled) {
                    if (activeSpotId === null) {
                        spot.style.pointerEvents = 'auto';
                        spot.classList.remove('locked', 'active-bet');
                    } else if (activeSpotId === spotId) {
                        spot.style.pointerEvents = 'auto';
                        spot.classList.remove('locked');
                        spot.classList.add('active-bet');
                    } else {
                        spot.style.pointerEvents = 'none';
                        spot.classList.add('locked');
                        spot.classList.remove('active-bet');
                    }
                } else {
                    spot.style.pointerEvents = 'none';
                    spot.classList.add('locked'); 
                }
            });
        }

        function resetGame() {
            gamePhase = 'betting';
            dealtCards = [];
            totalBet = 0;
            activeSpotId = null;
            
            betSpots.forEach(spot => {
                spot.querySelector('.current-bet').textContent = `ç±Œç¢¼: 0`;
            });
            
            renderCards(); 
            
            actionButtons.classList.remove('active');

            toggleBettingUI(true); 
            stopTimer(); 
            
            selectDefaultChip(); 

            messageArea.textContent = `è«‹é»æ“Šä¸€å€‹åº§ä½é–‹å§‹ä¸‹æ³¨ (10ç§’å€’æ•¸é–‹å§‹)ã€‚`;
            startTimer();
        }

        function selectDefaultChip() {
            const defaultChipWrapper = document.querySelector('.chip-wrapper[data-amount="100"]');
            if (defaultChipWrapper) {
                chipWrappers.forEach(w => w.classList.remove('selected-chip'));
                selectedChipAmount = 100;
                defaultChipWrapper.classList.add('selected-chip');
            }
        }

        // -------------------- éŠæˆ²æµç¨‹ (æ²¿ç”¨æç›Šä¿®æ­£) --------------------
        
        function startDealing() {
            gamePhase = 'waiting_action';
            toggleBettingUI(false); 
            stopTimer(); 
            
            dealtCards = [];
            let card1 = drawCard();
            let card2 = drawCard();
            
            const val1 = getCardValue(card1);
            const val2 = getCardValue(card2);

            if (val1 > val2) {
                [card1, card2] = [card2, card1];
            }
            dealtCards = [card1, card2];
            
            renderCards(dealtCards[0], dealtCards[1], 'BACK'); 
            positionCardDisplay(activeSpotId);

            actionButtons.classList.add('active');
            
            shootBtn.disabled = (playerChips < totalBet); 
            foldBtn.disabled = false;
            
            shootBtn.style.display = 'inline-block';
            foldBtn.style.display = 'inline-block';
            
            const [c1Rank, c2Rank] = dealtCards.map(c => c.split('_')[0]);
            
            if (shootBtn.disabled) {
                messageArea.textContent = `âš ï¸ ç±Œç¢¼ä¸è¶³ä»¥åŠ è¨» $${totalBet} å°„é–€ã€‚æ‚¨åªèƒ½é¸æ“‡æ£„ç‰Œã€‚`;
            } else {
                messageArea.textContent = `ç‰Œå·²ç™¼å‡ºï¼š ${c1Rank} å’Œ ${c2Rank}ã€‚è«‹é¸æ“‡ã€Œå°„é–€ã€(éœ€åŠ è¨» $${totalBet}) æˆ–ã€Œæ£„ç‰Œã€ã€‚`;
            }
        }
        
        function handleShoot() {
            if (gamePhase !== 'waiting_action') return;
            if (playerChips < totalBet) return; 

            // 1. å†æ¬¡ä¸‹æ³¨ (Double Down)
            playerChips -= totalBet; 
            playerChipsDisplay.textContent = playerChips;
            const totalBetAfterShoot = totalBet * 2; // ç¸½ä¸‹æ³¨é‡‘é¡ (å·²å¾ç±Œç¢¼æ‰£é™¤)

            const card3 = drawCard();
            
            const card3Val = getCardValue(card3);
            const [c1Val, c2Val] = dealtCards.map(getCardValue);
            
            let resultMessage = '';
            let outcome = 'lose'; 
            let netGain = 0; 

            // 2. åˆ¤æ–·å‹è² åŠè¨ˆç®—æç›Š
            if (card3Val === c1Val || card3Val === c2Val) {
                // æ’æŸ±ï¼šè¼¸æ‰ç¸½ä¸‹æ³¨é‡‘é¡ (å·²æ‰£é™¤) + é¡å¤–æ‡²ç½°
                const penalty = totalBet; 
                playerChips -= penalty; 
                playerChipsDisplay.textContent = playerChips;
                
                netGain = -(totalBetAfterShoot + penalty); 
                resultMessage = `ğŸš¨ æ’æŸ±ï¼è¼¸æ‰ç¸½ä¸‹æ³¨ $${totalBetAfterShoot}ï¼Œä¸¦é¡å¤–æ‡²ç½° $${penalty} (æ·¨è™§æ $${Math.abs(netGain)})ï¼`;
                outcome = 'lose';
            } 
            else if (card3Val > c1Val && card3Val < c2Val) {
                // æˆåŠŸï¼šç²å¾— 3 å€ç¸½ä¸‹æ³¨çš„çé‡‘ (åŒ…å«æœ¬é‡‘)
                const grossWinnings = totalBetAfterShoot * 3; 
                playerChips += grossWinnings; 
                
                netGain = grossWinnings - totalBetAfterShoot; 
                playerChipsDisplay.textContent = playerChips;

                resultMessage = `ğŸ‰ å°„é¾é–€æˆåŠŸï¼è´å¾—ç¸½çé‡‘ $${grossWinnings} (æ·¨åˆ©æ½¤ $${netGain})ï¼`;
                outcome = 'win';
            } 
            else {
                // å¤±æ•—ï¼šè¼¸æ‰ç¸½ä¸‹æ³¨é‡‘é¡ (å·²æ‰£é™¤ï¼Œç„¡éœ€é¡å¤–æ“ä½œ)
                netGain = -totalBetAfterShoot;
                resultMessage = `ğŸ˜­ å°„é–€å¤±æ•—ã€‚ç¸½ä¸‹æ³¨ $${totalBetAfterShoot} è¢«æ”¶èµ° (æ·¨è™§æ $${totalBetAfterShoot})ã€‚`;
                outcome = 'lose';
            }
            
            renderCards(dealtCards[0], dealtCards[1], card3, outcome); 
            positionCardDisplay(activeSpotId);
            
            messageArea.textContent = resultMessage;

            actionButtons.classList.remove('active');
            gamePhase = 'game_over';

            if (playerChips <= 0) {
                messageArea.textContent += " æ‚¨çš„ç±Œç¢¼å·²è€—ç›¡ï¼ŒéŠæˆ²çµæŸï¼";
            } else {
                 startAutoNewGameTimer(POST_GAME_TIME);
            }
        }
        
        function handleFold() {
            if (gamePhase !== 'waiting_action') return;

            messageArea.textContent = `æ‚¨é¸æ“‡äº†æ£„ç‰Œã€‚å·²ä¸‹æ³¨ç±Œç¢¼ $${totalBet} è¢«ç³»çµ±æ”¶èµ°ã€‚`;
            
            renderCards(dealtCards[0], dealtCards[1], 'BACK', 'lose'); 
            
            actionButtons.classList.remove('active');
            gamePhase = 'game_over';

            startAutoNewGameTimer(POST_GAME_TIME); 
        }


        // -------------------- äº‹ä»¶ç›£è½å™¨ (ä¿®æ­£ç±Œç¢¼é˜²å‘†é‚è¼¯) --------------------

        chipWrappers.forEach(wrapper => {
            wrapper.addEventListener('click', () => {
                if (gamePhase !== 'betting') return; 

                chipWrappers.forEach(w => w.classList.remove('selected-chip'));
                selectedChipAmount = parseInt(wrapper.dataset.amount);
                wrapper.classList.add('selected-chip');
                
                if (activeSpotId) {
                    messageArea.textContent = `å·²é¸æ“‡ $${selectedChipAmount} ç±Œç¢¼ã€‚é»æ“Šåº§ä½ ${activeSpotId} æŒçºŒä¸‹æ³¨...`;
                } else {
                    messageArea.textContent = `å·²é¸æ“‡ $${selectedChipAmount} ç±Œç¢¼ã€‚é»æ“Šä¸€å€‹åº§ä½é–‹å§‹éŠæˆ²ã€‚`;
                }
            });
        });

        betSpots.forEach(spot => {
            spot.addEventListener('click', () => {
                const spotId = spot.dataset.spot;
                
                if (gamePhase !== 'betting') return;
                
                if (selectedChipAmount === 0) { 
                    messageArea.textContent = "è«‹å…ˆé¸æ“‡æ‚¨è¦ä¸‹æ³¨çš„ç±Œç¢¼ï¼";
                    return;
                }
                if (playerChips < selectedChipAmount) {
                    messageArea.textContent = "æ‚¨çš„ç±Œç¢¼ä¸è¶³ï¼Œè«‹é¸æ“‡è¼ƒå°çš„é‡‘é¡ï¼";
                    return;
                }
                if (activeSpotId !== null && activeSpotId !== spotId) {
                    messageArea.textContent = `æ‚¨å·²é¸å®šåº§ä½ ${activeSpotId}ï¼Œç„¡æ³•åœ¨å…¶ä»–åº§ä½ä¸‹æ³¨ï¼`;
                    return;
                }
                
                // *** é—œéµä¿®æ­£ï¼šç±Œç¢¼é˜²å‘†é‚è¼¯ ***
                const potentialTotalBet = totalBet + selectedChipAmount;
                const requiredShootAmount = potentialTotalBet; // å°„é–€æ™‚éœ€è¦åŠ è¨»çš„é‡‘é¡ç­‰æ–¼ç¸½ä¸‹æ³¨é¡
                const remainingChipsAfterBet = playerChips - selectedChipAmount;

                // åˆ¤æ–·ï¼šä¸‹æ³¨å¾Œçš„å‰©é¤˜ç±Œç¢¼ < å°„é–€æ‰€éœ€åŠ è¨»é‡‘é¡
                if (activeSpotId !== null && remainingChipsAfterBet < requiredShootAmount) {
                    messageArea.textContent = `âš ï¸ ä¸‹æ³¨å¾Œ ($${potentialTotalBet}) å°‡å°è‡´ç±Œç¢¼éå°‘ ($${remainingChipsAfterBet})ï¼Œä¸è¶³ä»¥åœ¨ä¸‹ä¸€éšæ®µåŠ è¨»å°„é–€ ($${requiredShootAmount})ã€‚è«‹æ¸›å°‘ä¸‹æ³¨é‡‘é¡ã€‚`;
                    return;
                }
                
                if (activeSpotId === null) {
                    activeSpotId = spotId;
                    toggleBettingUI(true); 
                }

                playerChips -= selectedChipAmount;
                totalBet += selectedChipAmount; 

                playerChipsDisplay.textContent = playerChips;
                spot.querySelector('.current-bet').textContent = `ç±Œç¢¼: ${totalBet}`;
                messageArea.textContent = `ç¸½ä¸‹æ³¨ $${totalBet}ã€‚è«‹åœ¨å€’æ•¸çµæŸå‰æŒçºŒä¸‹æ³¨...`;
            });
        });

        shootBtn.addEventListener('click', handleShoot);
        foldBtn.addEventListener('click', handleFold);

        window.addEventListener('resize', () => {
            if (activeSpotId && gamePhase !== 'betting') {
                 positionCardDisplay(activeSpotId);
            }
        });

        // éŠæˆ²é–‹å§‹
        resetGame(); 
    </script>
</body>
</html>